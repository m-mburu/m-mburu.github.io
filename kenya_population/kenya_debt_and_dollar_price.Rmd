---
title: "USD-KES Hisotrical Data"
author: "Mburu"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float:
      collapsed: false
      smooth_scroll: false
    theme: united
    highlight: pygments
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE)
```

##

```{r}
library(plotly)
library(tidyverse)
library(data.table)
library(DT)
library(ggthemes)
library(patchwork)
usd_kes_hist <- fread("USD_KES Historical Data.csv")
```

```{r}
usd_kes_hist[, Date :=  as.Date(Date, format = "%b %d,%Y")]
```


```{r, fig.width=7, fig.height=5}

x <- as.Date("2002-12-01")
x_end <- as.Date("2003-01-01")

y <-90
y_end <- 77.500

x_uhuru <- as.Date("2013-03-09")
x_end_uhuru <- as.Date("2013-04-09")

y_uhuru <-105
y_end_uhuru <- 85.600

dollar <- ggplot(usd_kes_hist,aes(Date, Price))+
    geom_line()+
    scale_x_date(date_breaks = "3 year", date_labels = "%b-%y")+
    labs(y = "1 USD to KES", title = "Historical Prices USD to KES")+
    annotate(
    geom = "curve", x = x, y = y, xend = x_end, yend = y_end, 
    curvature = .3, arrow = arrow(length = unit(3, "mm"))
  ) +
  annotate(geom = "text", x = x, y = y, label = "Pres Kibaki \n takes Office", hjust = "left",
           angle = 30)+
    annotate(
    geom = "curve", x = x_uhuru, y = y_uhuru, xend = x_end_uhuru, yend = y_end_uhuru, 
    curvature = .1, arrow = arrow(length = unit(3, "mm"))
  ) +
  annotate(geom = "text", x = x_uhuru, y = y_uhuru+2, label = "Pres Uhuru \n takes Office", hjust = "left",
           angle = 30)
dollar
```


```{r}


kenya_debt <- read_csv( "kenya_debt/Public Debt (Ksh Million).csv") %>% setDT()

kenya_debt[, Date := as.Date(paste(Year, Month, "01", sep = "-"), format = "%Y-%B-%d")]

kenya_debt[, Total := Total/1000000]
```


```{r, fig.width=7, fig.height=5}
x <- as.Date("2002-12-01")
x_end <- as.Date("2003-01-01")

y <-2.000000
y_end <- .6152281

x_uhuru <- as.Date("2013-03-09")
x_end_uhuru <- as.Date("2013-04-09")

y_uhuru <-4.000000
y_end_uhuru <- 1.8824059


debt <- ggplot(kenya_debt, aes(Date, Total)) +
    geom_line()+
    scale_x_date(date_breaks = "3 year", date_labels = "%b-%y")+
    labs(title = "Kenya Debt from 1999 to 2020 June", y = "Total Debt in Trillions(KES)")+
    annotate(
    geom = "curve", x = x, y = y, xend = x_end, yend = y_end, 
    curvature = .3, arrow = arrow(length = unit(2, "mm"))
  ) +
  annotate(geom = "text", x = x, y = y, label = "Pres Kibaki \n takes Office", hjust = "left",
           angle = 30)+
    annotate(
    geom = "curve", x = x_uhuru, y = y_uhuru, xend = x_end_uhuru, yend = y_end_uhuru, 
    curvature = -.1, arrow = arrow(length = unit(3, "mm"))
  ) +
  annotate(geom = "text", x = x_uhuru, y = y_uhuru+.5, label = "Pres Uhuru \n takes Office", hjust = "right",
           angle = 30)
 

debt
```



```{r , fig.width=7, fig.height=10}
debt/ dollar
```


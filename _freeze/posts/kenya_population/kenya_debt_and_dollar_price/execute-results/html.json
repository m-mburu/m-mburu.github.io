{
  "hash": "e5cb77e375194dc9ef662b5080715344",
  "result": {
    "markdown": "---\ntitle: \"USD-KES Hisotrical Data\"\nauthor: \"Mburu\"\ndate: \"2023-02-11\"\noutput:\n  html_document:\n    toc: true\n    toc_depth: 2\n    toc_float:\n      collapsed: false\n      smooth_scroll: false\n    theme: united\n    highlight: pygments\n---\n\n\n\n\n##\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(DT)\nlibrary(ggthemes)\nlibrary(patchwork)\nusd_kes_hist <- fread(\"USD_KES Historical Data.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nusd_kes_hist[, Date :=  as.Date(Date, format = \"%b %d,%Y\")]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- as.Date(\"2002-12-01\")\nx_end <- as.Date(\"2003-01-01\")\n\ny <-90\ny_end <- 77.500\n\nx_uhuru <- as.Date(\"2013-03-09\")\nx_end_uhuru <- as.Date(\"2013-04-09\")\n\ny_uhuru <-105\ny_end_uhuru <- 85.600\n\ndollar <- ggplot(usd_kes_hist,aes(Date, Price))+\n    geom_line()+\n    scale_x_date(date_breaks = \"3 year\", date_labels = \"%b-%y\")+\n    labs(y = \"1 USD to KES\", title = \"Historical Prices USD to KES\")+\n  \n    annotate(\n    geom = \"curve\", x = x, y = y, xend = x_end, yend = y_end, \n    curvature = .3, arrow = arrow(length = unit(3, \"mm\"))\n  ) +\n  annotate(geom = \"text\", x = x, y = y,\n           label = \"Pres Kibaki \\n takes Office\", hjust = \"left\",\n           angle = 30)+\n    annotate(\n    geom = \"curve\", x = x_uhuru, y = y_uhuru, \n    xend = x_end_uhuru, yend = y_end_uhuru, \n    curvature = .1, arrow = arrow(length = unit(3, \"mm\"))\n  ) +\n  annotate(geom = \"text\", x = x_uhuru, y = y_uhuru+2,\n           label = \"Pres Uhuru \\n takes Office\", hjust = \"left\",\n           angle = 30)\ndollar\n```\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkenya_debt <- read_csv( \"kenya_debt/Public Debt (Ksh Million).csv\") %>% setDT()\n\nkenya_debt[, Date := as.Date(paste(Year, Month, \"01\", sep = \"-\"), format = \"%Y-%B-%d\")]\nkenya_debt[, perc_external := round(`External Debt`/Total* 100, 1)]\nkenya_debt[, Total := Total/1000000]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- as.Date(\"2002-12-01\")\nx_end <- as.Date(\"2003-01-01\")\n\ny <-2.000000\ny_end <- .6152281\n\nx_uhuru <- as.Date(\"2013-03-09\")\nx_end_uhuru <- as.Date(\"2013-04-09\")\n\ny_uhuru <-4.000000\ny_end_uhuru <- 1.8824059\n\n\ndebt <- ggplot(kenya_debt, aes(Date, Total)) +\n    geom_line()+\n  \n    scale_x_date(date_breaks = \"3 year\", date_labels = \"%b-%y\")+\n  \n    labs(title = \"Kenya Debt from 1999 to 2020 June\",\n         y = \"Total Debt in Trillions(KES)\")+\n  \n    annotate(\n    geom = \"curve\", x = x, y = y, xend = x_end, yend = y_end, \n    curvature = .3, arrow = arrow(length = unit(2, \"mm\"))\n  ) +\n  annotate(geom = \"text\", x = x, y = y,\n           label = \"Pres Kibaki \\n takes Office\", hjust = \"left\",\n           angle = 30)+\n  \n    annotate(\n    geom = \"curve\", x = x_uhuru, y = y_uhuru, \n    xend = x_end_uhuru, yend = y_end_uhuru, \n    curvature = -.1, arrow = arrow(length = unit(3, \"mm\"))\n  ) +\n  \n  annotate(geom = \"text\", x = x_uhuru, y = y_uhuru+.5,\n           label = \"Pres Uhuru \\n takes Office\", hjust = \"right\",\n           angle = 30)\n \n\ndebt\n```\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_breaks <- seq(15, 70, 5)\nexternal <- ggplot(kenya_debt, aes(Date, perc_external)) +\n    geom_line()+\n  \n    scale_x_date(date_breaks = \"2 year\", date_labels = \"%Y\")+\n  \n    labs(title = \"Kenya External Debt % from 1999 to 2020 June\",\n         y = \"External Debt (%)\")+\n    theme_hc()+\n    scale_y_continuous(breaks = my_breaks )\n\nexternal\n```\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_data <- fread(\"poverty_data/IDS-DRSCountries_WLD_Data.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnms_old <-debt_data[1,]  %>% as.character()\nnms_old\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Country Name\"          \"Country Code\"          \"Counterpart-Area Name\"\n [4] \"Counterpart-Area Code\" \"Series Name\"           \"Series Code\"          \n [7] \"1970\"                  \"1971\"                  \"1972\"                 \n[10] \"1973\"                  \"1974\"                  \"1975\"                 \n[13] \"1976\"                  \"1977\"                  \"1978\"                 \n[16] \"1979\"                  \"1980\"                  \"1981\"                 \n[19] \"1982\"                  \"1983\"                  \"1984\"                 \n[22] \"1985\"                  \"1986\"                  \"1987\"                 \n[25] \"1988\"                  \"1989\"                  \"1990\"                 \n[28] \"1991\"                  \"1992\"                  \"1993\"                 \n[31] \"1994\"                  \"1995\"                  \"1996\"                 \n[34] \"1997\"                  \"1998\"                  \"1999\"                 \n[37] \"2000\"                  \"2001\"                  \"2002\"                 \n[40] \"2003\"                  \"2004\"                  \"2005\"                 \n[43] \"2006\"                  \"2007\"                  \"2008\"                 \n[46] \"2009\"                  \"2010\"                  \"2011\"                 \n[49] \"2012\"                  \"2013\"                  \"2014\"                 \n[52] \"2015\"                  \"2016\"                  \"2017\"                 \n[55] \"2018\"                  \"2019\"                  \"2020\"                 \n[58] \"2021\"                  \"2022\"                  \"2023\"                 \n[61] \"2024\"                  \"2025\"                  \"2026\"                 \n[64] \"2027\"                 \n```\n:::\n\n```{.r .cell-code}\ndebt_data <-debt_data[-1,]\nnames(debt_data) <- nms_old\nnms_new <- nms_old %>% tolower() \nnms_new <- gsub(\"\\\\s|-\", \"_\", nms_new)\nnms_new\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"country_name\"          \"country_code\"          \"counterpart_area_name\"\n [4] \"counterpart_area_code\" \"series_name\"           \"series_code\"          \n [7] \"1970\"                  \"1971\"                  \"1972\"                 \n[10] \"1973\"                  \"1974\"                  \"1975\"                 \n[13] \"1976\"                  \"1977\"                  \"1978\"                 \n[16] \"1979\"                  \"1980\"                  \"1981\"                 \n[19] \"1982\"                  \"1983\"                  \"1984\"                 \n[22] \"1985\"                  \"1986\"                  \"1987\"                 \n[25] \"1988\"                  \"1989\"                  \"1990\"                 \n[28] \"1991\"                  \"1992\"                  \"1993\"                 \n[31] \"1994\"                  \"1995\"                  \"1996\"                 \n[34] \"1997\"                  \"1998\"                  \"1999\"                 \n[37] \"2000\"                  \"2001\"                  \"2002\"                 \n[40] \"2003\"                  \"2004\"                  \"2005\"                 \n[43] \"2006\"                  \"2007\"                  \"2008\"                 \n[46] \"2009\"                  \"2010\"                  \"2011\"                 \n[49] \"2012\"                  \"2013\"                  \"2014\"                 \n[52] \"2015\"                  \"2016\"                  \"2017\"                 \n[55] \"2018\"                  \"2019\"                  \"2020\"                 \n[58] \"2021\"                  \"2022\"                  \"2023\"                 \n[61] \"2024\"                  \"2025\"                  \"2026\"                 \n[64] \"2027\"                 \n```\n:::\n\n```{.r .cell-code}\nsetnames(debt_data, nms_old, nms_new)\nid_vars <- c(\"country_name\", \"country_code\", \"counterpart_area_name\", \n             \"counterpart_area_code\", \"series_name\", \"series_code\")\n\ndebt_data <- melt(debt_data,\n                                id.vars = id_vars, \n                           variable.factor = F,\n                           value.factor = F,\n                           variable.name = \"year\")\n\ndebt_data[, year := str_trim(year)]\ndebt_data[, year := as.numeric(year)]\ndebt_data <-  debt_data[!is.na(value)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nindicator_name <- c(\"Currency composition of PPG debt, U.S. dollars (%)\",\n                    \"Interest payments on external debt (% of exports of goods, services and primary income)\",\n                    \"Interest payments on external debt (% of GNI)\",\n                     \"Short-term debt (% of total external debt)\",\n                     \"Multilateral debt (% of total external debt)\" )\n\n#debt_data[, unique(country_name)]\n#debt_data[, unique(series_name)]\n#\"Uganda\", \"Tanzania\"\nea_country <- c(\"Kenya\", \"Lower middle income\" )\n\n\ndebt_data <- debt_data[country_name %in% ea_country & series_name %in% indicator_name]\ndebt_data_split <- split(debt_data, f = debt_data$series_name)\n\nn <- length(debt_data_split)\nmy_plots <-htmltools::tagList()\nmy_plots <- list()\nfor (i in 1:n) {\n    df = debt_data_split[[i]]\n    my_title = df[, unique(series_name)]\n    mn = df[, min(year)]\n    mx = df[, max(year)]\n    breaks = seq(mn, mx,by = 3)\n    p = ggplot(df, aes(year, value, group = country_name, color = country_name) ) +\n        geom_line()+\n        theme_hc()+\n        labs(title = my_title, x = \"year\", y = \"%\")+\n      scale_color_viridis_d(name=\"\")+\n      scale_x_continuous(breaks = breaks)\n    \n   # my_plots[[i]] = ggplotly(p)\n    my_plots[[i]] = p\n    \n}\n\nmy_plots\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-9-1.png){width=864}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n[[2]]\n```\n:::\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-9-2.png){width=864}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n[[3]]\n```\n:::\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-9-3.png){width=864}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n[[4]]\n```\n:::\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-9-4.png){width=864}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n[[5]]\n```\n:::\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-9-5.png){width=864}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nworld_debt_data  <- fread(\"poverty_data/API_DT.TDS.DECT.EX.ZS_DS2_en_csv_v2_1865914.csv\", \n                          skip = 4, header = T)\n\nnms_old <- names(world_debt_data)\n\nnms_new <- nms_old %>% tolower() \nnms_new <- gsub(\"\\\\s|-\", \"_\", nms_new)\nnms_new\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"country_name\"   \"country_code\"   \"indicator_name\" \"indicator_code\"\n [5] \"1960\"           \"1961\"           \"1962\"           \"1963\"          \n [9] \"1964\"           \"1965\"           \"1966\"           \"1967\"          \n[13] \"1968\"           \"1969\"           \"1970\"           \"1971\"          \n[17] \"1972\"           \"1973\"           \"1974\"           \"1975\"          \n[21] \"1976\"           \"1977\"           \"1978\"           \"1979\"          \n[25] \"1980\"           \"1981\"           \"1982\"           \"1983\"          \n[29] \"1984\"           \"1985\"           \"1986\"           \"1987\"          \n[33] \"1988\"           \"1989\"           \"1990\"           \"1991\"          \n[37] \"1992\"           \"1993\"           \"1994\"           \"1995\"          \n[41] \"1996\"           \"1997\"           \"1998\"           \"1999\"          \n[45] \"2000\"           \"2001\"           \"2002\"           \"2003\"          \n[49] \"2004\"           \"2005\"           \"2006\"           \"2007\"          \n[53] \"2008\"           \"2009\"           \"2010\"           \"2011\"          \n[57] \"2012\"           \"2013\"           \"2014\"           \"2015\"          \n[61] \"2016\"           \"2017\"           \"2018\"           \"2019\"          \n[65] \"2020\"           \"v66\"           \n```\n:::\n\n```{.r .cell-code}\nsetnames(world_debt_data, nms_old, nms_new)\n\nid_vars_debt <- nms_new[1:4]\nworld_debt_data <- melt(world_debt_data,\n                           id.vars = id_vars_debt,\n                           variable.factor = F,\n                           value.factor = F,\n                           variable.name = \"year\")\nworld_debt_data[, year := as.numeric(year)]\nworld_debt_data[, value := as.numeric(value)]\nworld_debt_data <- world_debt_data[!is.na(year)]\nworld_debt_data <- world_debt_data[!is.na(value)]\nhead(world_debt_data[country_name == \"Kenya\"], 10) %>%\n  datatable(options = list(scrollX= T))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-decea07f1157686f41ee\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-decea07f1157686f41ee\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\",\"Kenya\"],[\"KEN\",\"KEN\",\"KEN\",\"KEN\",\"KEN\",\"KEN\",\"KEN\",\"KEN\",\"KEN\",\"KEN\"],[\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\",\"Total debt service (% of exports of goods, services and primary income)\"],[\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\",\"DT.TDS.DECT.EX.ZS\"],[1975,1976,1977,1978,1979,1980,1981,1982,1983,1984],[14.9366847944077,14.8104650367997,20.4520757631118,13.9745766381538,18.3721447470291,21.0285042554811,26.9657704290968,30.4825101956896,33.7741974314409,34.7957612480719]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>country_name<\\/th>\\n      <th>country_code<\\/th>\\n      <th>indicator_name<\\/th>\\n      <th>indicator_code<\\/th>\\n      <th>year<\\/th>\\n      <th>value<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"scrollX\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[5,6]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nea_country <- c(\"Kenya\", \"Lower middle income\" )\n\n\nworld_debt_data <- world_debt_data[country_name %in% ea_country]\nworld_debt_data_split <- split(world_debt_data, f = world_debt_data$indicator_name)\n\nn <- length(world_debt_data_split)\nmy_plots <-htmltools::tagList()\nmy_plots <- list()\nfor (i in 1:n) {\n    df = world_debt_data_split[[i]]\n    my_title = df[, unique(indicator_name)]\n    mn = df[, min(year)]\n    mx = df[, max(year)]\n    breaks = seq(mn, mx,by = 3)\n    p = ggplot(df, aes(year, value, group = country_name, color = country_name) ) +\n        geom_line()+\n        theme_hc()+\n        labs(title = my_title, x = \"year\", y = \"%\")+\n      scale_color_viridis_d(name=\"\")+\n      scale_x_continuous(breaks = breaks)\n    \n   # my_plots[[i]] = ggplotly(p)\n    my_plots[[i]] = p\n    \n}\n\nmy_plots\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](kenya_debt_and_dollar_price_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "kenya_debt_and_dollar_price_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.27/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
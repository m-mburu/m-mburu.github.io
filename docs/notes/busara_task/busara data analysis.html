<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="mburu">
<meta name="dcterms.date" content="2019-02-16">

<title>Personal Blog - Exploratory Data Analysis for Busara task</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../milkyway.jpeg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BFNZ97VTLJ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BFNZ97VTLJ', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../style.css">
<meta property="og:title" content="Personal Blog - Exploratory Data Analysis for Busara task">
<meta property="og:description" content="#Single Ladies Nyeri">
<meta property="og:site-name" content="Personal Blog">
<meta name="twitter:title" content="Personal Blog - Exploratory Data Analysis for Busara task">
<meta name="twitter:description" content="#Single Ladies Nyeri">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Personal Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../datacamp.html">
 <span class="menu-text">Data Camp Courses</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/m-mburu"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/mmburu_w"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#task-1" id="toc-task-1" class="nav-link active" data-scroll-target="#task-1"><strong><em>Task 1</em></strong></a></li>
  <li><a href="#summary-statistics-age-and-income" id="toc-summary-statistics-age-and-income" class="nav-link" data-scroll-target="#summary-statistics-age-and-income"><strong><em>Summary Statistics Age and Income</em></strong></a></li>
  <li><a href="#gender-gap" id="toc-gender-gap" class="nav-link" data-scroll-target="#gender-gap"><strong><em>% gender Gap</em></strong></a></li>
  <li><a href="#gender-gap-1" id="toc-gender-gap-1" class="nav-link" data-scroll-target="#gender-gap-1"><strong><em>% gender Gap</em></strong></a></li>
  <li><a href="#summary-statistics-single-ladies-nyeri" id="toc-summary-statistics-single-ladies-nyeri" class="nav-link" data-scroll-target="#summary-statistics-single-ladies-nyeri"><strong><em>Summary Statistics Single Ladies Nyeri</em></strong></a></li>
  <li><a href="#number-of-juniors" id="toc-number-of-juniors" class="nav-link" data-scroll-target="#number-of-juniors"><strong><em>Number of Juniors</em></strong></a></li>
  <li><a href="#difference-in-mean-income-between-male-and-female" id="toc-difference-in-mean-income-between-male-and-female" class="nav-link" data-scroll-target="#difference-in-mean-income-between-male-and-female"><strong><em>Difference in mean income between male and female</em></strong></a></li>
  <li><a href="#function-to-plot-categorical-variables" id="toc-function-to-plot-categorical-variables" class="nav-link" data-scroll-target="#function-to-plot-categorical-variables"><strong><em>Function to plot categorical variables</em></strong></a></li>
  <li><a href="#function-to-plot-categorical-variables-test-1" id="toc-function-to-plot-categorical-variables-test-1" class="nav-link" data-scroll-target="#function-to-plot-categorical-variables-test-1"><strong><em>Function to plot categorical variables test 1</em></strong></a></li>
  <li><a href="#function-to-plot-categorical-variables-test-2" id="toc-function-to-plot-categorical-variables-test-2" class="nav-link" data-scroll-target="#function-to-plot-categorical-variables-test-2"><strong><em>Function to plot categorical variables test 2</em></strong></a></li>
  <li><a href="#task-2" id="toc-task-2" class="nav-link" data-scroll-target="#task-2"><strong><em>Task 2</em></strong></a></li>
  <li><a href="#combine-files" id="toc-combine-files" class="nav-link" data-scroll-target="#combine-files">Combine Files</a></li>
  <li><a href="#head-output-data-frame" id="toc-head-output-data-frame" class="nav-link" data-scroll-target="#head-output-data-frame"><strong><em>Head output data frame</em></strong></a></li>
  <li><a href="#head-output-kenya-data" id="toc-head-output-kenya-data" class="nav-link" data-scroll-target="#head-output-kenya-data"><strong><em>Head output kenya data</em></strong></a></li>
  <li><a href="#head-output-kenya-data-and-saving-files" id="toc-head-output-kenya-data-and-saving-files" class="nav-link" data-scroll-target="#head-output-kenya-data-and-saving-files"><strong><em>Head output kenya data and saving files</em></strong></a></li>
  <li><a href="#task-3-plots" id="toc-task-3-plots" class="nav-link" data-scroll-target="#task-3-plots">Task 3 Plots</a></li>
  <li><a href="#average-amount-saved-at-the-bank" id="toc-average-amount-saved-at-the-bank" class="nav-link" data-scroll-target="#average-amount-saved-at-the-bank"><strong><em>Average Amount saved at the Bank</em></strong></a></li>
  <li><a href="#average-amount-saved-at-the-agent" id="toc-average-amount-saved-at-the-agent" class="nav-link" data-scroll-target="#average-amount-saved-at-the-agent"><strong><em>Average Amount saved at the Agent</em></strong></a></li>
  <li><a href="#average-amount-saved-mobile-money" id="toc-average-amount-saved-mobile-money" class="nav-link" data-scroll-target="#average-amount-saved-mobile-money"><strong><em>Average Amount saved Mobile money</em></strong></a></li>
  <li><a href="#end-month-savings-favourite-tool" id="toc-end-month-savings-favourite-tool" class="nav-link" data-scroll-target="#end-month-savings-favourite-tool"><strong><em>End Month Savings Favourite tool</em></strong></a></li>
  <li><a href="#histogram-deposits" id="toc-histogram-deposits" class="nav-link" data-scroll-target="#histogram-deposits">Histogram Deposits</a></li>
  <li><a href="#subset-people-who-have-made-one-deposit" id="toc-subset-people-who-have-made-one-deposit" class="nav-link" data-scroll-target="#subset-people-who-have-made-one-deposit"><strong><em>Subset People who have made one deposit</em></strong></a></li>
  <li><a href="#demographic-characteristics-of-those-who-have-only-made-one-deposit" id="toc-demographic-characteristics-of-those-who-have-only-made-one-deposit" class="nav-link" data-scroll-target="#demographic-characteristics-of-those-who-have-only-made-one-deposit"><strong><em>Demographic characteristics of those who have only made one deposit</em></strong></a></li>
  <li><a href="#gender" id="toc-gender" class="nav-link" data-scroll-target="#gender"><strong><em>Gender</em></strong></a></li>
  <li><a href="#region" id="toc-region" class="nav-link" data-scroll-target="#region"><strong><em>Region</em></strong></a></li>
  <li><a href="#age" id="toc-age" class="nav-link" data-scroll-target="#age"><strong><em>Age</em></strong></a></li>
  <li><a href="#task-4" id="toc-task-4" class="nav-link" data-scroll-target="#task-4"><strong><em>Task 4</em></strong></a></li>
  <li><a href="#project-motivation" id="toc-project-motivation" class="nav-link" data-scroll-target="#project-motivation"><strong><em>Project Motivation</em></strong></a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><strong><em>Data Cleaning</em></strong></a></li>
  <li><a href="#variable-selection" id="toc-variable-selection" class="nav-link" data-scroll-target="#variable-selection"><strong><em>Variable Selection</em></strong></a></li>
  <li><a href="#visualize-categorical-variables" id="toc-visualize-categorical-variables" class="nav-link" data-scroll-target="#visualize-categorical-variables"><strong><em>Visualize Categorical variables</em></strong></a></li>
  <li><a href="#visualize-numeric-variables" id="toc-visualize-numeric-variables" class="nav-link" data-scroll-target="#visualize-numeric-variables"><strong><em>Visualize numeric variables</em></strong></a></li>
  <li><a href="#one-hot-encoding-for-categorical-variables-with-more-than-2-levels" id="toc-one-hot-encoding-for-categorical-variables-with-more-than-2-levels" class="nav-link" data-scroll-target="#one-hot-encoding-for-categorical-variables-with-more-than-2-levels"><strong><em>One-Hot Encoding for categorical variables with more than 2 levels</em></strong></a></li>
  <li><a href="#scale-variables" id="toc-scale-variables" class="nav-link" data-scroll-target="#scale-variables"><strong><em>Scale variables</em></strong></a></li>
  <li><a href="#split-test-and-train-sets" id="toc-split-test-and-train-sets" class="nav-link" data-scroll-target="#split-test-and-train-sets"><strong><em>Split test and train sets</em></strong></a></li>
  <li><a href="#fit-logistic-regression" id="toc-fit-logistic-regression" class="nav-link" data-scroll-target="#fit-logistic-regression"><strong><em>Fit Logistic Regression</em></strong></a></li>
  <li><a href="#confusion-matrix-logistic-regression" id="toc-confusion-matrix-logistic-regression" class="nav-link" data-scroll-target="#confusion-matrix-logistic-regression"><strong><em>Confusion Matrix Logistic regression</em></strong></a></li>
  <li><a href="#accuracy-logistic-regression" id="toc-accuracy-logistic-regression" class="nav-link" data-scroll-target="#accuracy-logistic-regression"><strong><em>Accuracy Logistic regression</em></strong></a></li>
  <li><a href="#area-under-curve" id="toc-area-under-curve" class="nav-link" data-scroll-target="#area-under-curve"><strong><em>Area under curve</em></strong></a></li>
  <li><a href="#cross-validation-svm" id="toc-cross-validation-svm" class="nav-link" data-scroll-target="#cross-validation-svm"><strong><em>Cross Validation SVM</em></strong></a></li>
  <li><a href="#confusion-matrix-svm" id="toc-confusion-matrix-svm" class="nav-link" data-scroll-target="#confusion-matrix-svm"><strong><em>Confusion Matrix SVM</em></strong></a></li>
  <li><a href="#area-under-curve-1" id="toc-area-under-curve-1" class="nav-link" data-scroll-target="#area-under-curve-1"><strong><em>Area under curve</em></strong></a></li>
  <li><a href="#accuracy-svm" id="toc-accuracy-svm" class="nav-link" data-scroll-target="#accuracy-svm"><strong><em>Accuracy SVM</em></strong></a></li>
  <li><a href="#validation-curves" id="toc-validation-curves" class="nav-link" data-scroll-target="#validation-curves"><strong><em>Validation Curves</em></strong></a></li>
  <li><a href="#deployment" id="toc-deployment" class="nav-link" data-scroll-target="#deployment"><strong><em>Deployment</em></strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploratory Data Analysis for Busara task</h1>
  <div class="quarto-categories">
    <div class="quarto-category">news</div>
    <div class="quarto-category">code</div>
    <div class="quarto-category">analysis</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>mburu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 16, 2019</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#library(data_tableExtra)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="task-1" class="level1">
<h1><strong><em>Task 1</em></strong></h1>
<ul>
<li><p>Understanding the demographics of company xyz.</p></li>
<li><p>At least half are youth average age = 33.5</p></li>
<li><p>At least half earn 5557</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>xyz <span class="ot">&lt;-</span> <span class="fu">setDT</span>(<span class="fu">read_csv</span>(<span class="st">"XYZ.csv"</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>xyz_sub <span class="ot">&lt;-</span> xyz[, .(Gender, Age, Income)]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>xyz_subm <span class="ot">&lt;-</span> <span class="fu">melt</span>(xyz_sub, <span class="at">id.vars =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-age-and-income" class="level1">
<h1><strong><em>Summary Statistics Age and Income</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>xyz_subm <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Average =</span> <span class="fu">mean</span>(value), <span class="at">Median =</span> <span class="fu">median</span>(value),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Min =</span> <span class="fu">min</span>(value), <span class="at">Max =</span> <span class="fu">max</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>() <span class="co">#%&gt;% data_table_styling() %&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gender-gap" class="level1">
<h1><strong><em>% gender Gap</em></strong></h1>
<ul>
<li>Male/Female % al most equal</li>
<li>There are 5.2% more men than women</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> xyz <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Gender) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Perc =</span> <span class="fu">round</span>(freq<span class="sc">/</span><span class="fu">sum</span>(freq) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>gender <span class="sc">%&gt;%</span> <span class="fu">data_table</span>() <span class="co">#%&gt;% data_table_styling() %&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gender-gap-1" class="level1">
<h1><strong><em>% gender Gap</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gender[, <span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">spread</span>(Gender, Perc) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Percentage_Gender_Gap =</span> Male <span class="sc">-</span> Female) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>() <span class="co">#%&gt;% data_table_styling() %&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#<strong><em>Single Ladies Nyeri</em></strong></p>
<ul>
<li>12(2.4% of the company employees) single ladies from Nyeri county</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>single_nyeri <span class="ot">&lt;-</span> xyz[Gender <span class="sc">==</span> <span class="st">"Female"</span> <span class="sc">&amp;</span> Marital_Status <span class="sc">==</span> <span class="st">"Single"</span> <span class="sc">&amp;</span> County <span class="sc">==</span> <span class="st">"Nyeri"</span>,]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(xyz)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The Number of single ladies in Nyeri is "</span>, <span class="fu">nrow</span>(single_nyeri))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-statistics-single-ladies-nyeri" class="level1">
<h1><strong><em>Summary Statistics Single Ladies Nyeri</em></strong></h1>
<ul>
<li>Average age 36 and medium income is about $50</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>single_nyeri <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Average_Age =</span> <span class="fu">mean</span>(Age), <span class="at">Median_Income =</span> <span class="fu">median</span>(Income)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>() <span class="co">#%&gt;%  data_table_styling() %&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="number-of-juniors" class="level1">
<h1><strong><em>Number of Juniors</em></strong></h1>
<ul>
<li>28 juniors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>juniors_26 <span class="ot">&lt;-</span>xyz[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"Operartions|Data"</span>,Department)  <span class="sc">&amp;</span> xyz<span class="sc">$</span>Age <span class="sc">&lt;</span> <span class="dv">26</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"Junior"</span>, Role),]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The Number of juniors "</span>, <span class="fu">nrow</span>(juniors_26))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>juniors_26 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Department) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Perc =</span> <span class="fu">round</span>(freq<span class="sc">/</span><span class="fu">sum</span>(freq) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>() <span class="co">#%&gt;% data_table_styling() %&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "40%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="difference-in-mean-income-between-male-and-female" class="level1">
<h1><strong><em>Difference in mean income between male and female</em></strong></h1>
<ul>
<li>The Operations has the biggest difference in mean income</li>
<li>Female/Males average earnings in different departments</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>income_gender <span class="ot">&lt;-</span> xyz <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Gender, Department) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Average =</span> <span class="fu">mean</span>(Income))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>income_gender_dcast <span class="ot">&lt;-</span> <span class="fu">dcast</span>(Department <span class="sc">~</span> Gender, <span class="at">data =</span> income_gender) </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>income_gender_dcast <span class="sc">%&gt;%</span> <span class="fu">mutate</span>( <span class="at">Difference =</span> Male <span class="sc">-</span> Female) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>()<span class="co">#%&gt;% data_table_styling() %&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "45%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-to-plot-categorical-variables" class="level1">
<h1><strong><em>Function to plot categorical variables</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bar_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title,...) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#load ggplot2</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#function takes a data frame</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#and other arguments that ggplot</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#function from ggplot2 takes</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the other arguments are aesthetic mappings</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">require</span>(ggplot2)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(data) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(...))<span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(title)<span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        ggthemes<span class="sc">::</span><span class="fu">theme_hc</span>()<span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        ggthemes<span class="sc">::</span><span class="fu">scale_fill_hc</span>()<span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-to-plot-categorical-variables-test-1" class="level1">
<h1><strong><em>Function to plot categorical variables test 1</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bar_plot</span>(xyz, Department, <span class="at">title =</span> <span class="st">"Department Distribution"</span>, <span class="at">fill =</span> Department)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-to-plot-categorical-variables-test-2" class="level1">
<h1><strong><em>Function to plot categorical variables test 2</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bar_plot</span>(xyz, Gender, <span class="at">title =</span> <span class="st">"Gender Distibution"</span>, <span class="at">fill =</span> Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-2" class="level1">
<h1><strong><em>Task 2</em></strong></h1>
<p><strong><em>Read Files</em></strong></p>
<ul>
<li>Read files using the patterns</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my_files <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="at">path =</span> <span class="st">"Education"</span>,<span class="at">pattern =</span> <span class="st">"^Chi|^Sch|^Persi|Secon|^Progr|Pri"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>my_files <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Education/"</span>, my_files)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>list_files <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(my_files)) {</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">read_excel</span>(my_files[i]) </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    id <span class="ot">=</span> <span class="fu">grep</span>(<span class="st">"Country Name"</span>, x<span class="sc">$</span><span class="st">`</span><span class="at">Data Source</span><span class="st">`</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    nms <span class="ot">&lt;-</span> x[id,]</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(x) <span class="ot">&lt;-</span> nms <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    list_files[[i]] <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>id),] </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"..."</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-files" class="level1">
<h1>Combine Files</h1>
<ul>
<li>Since files are stored in a list combine them</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_world <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(list_files) <span class="sc">%&gt;%</span> <span class="fu">setDT</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df_world_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(df_world, <span class="at">id.vars =</span> <span class="fu">names</span>(df_world)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>nms2 <span class="ot">&lt;-</span> Hmisc<span class="sc">::</span><span class="fu">Cs</span>(Country_Name, Country_Code,   </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>          Indicator_Name,   Indicator_Code, Year,   Indicator_value)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_world_melt) <span class="ot">&lt;-</span> nms2</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>df_world_melt[,  Year <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(df_world_melt<span class="sc">$</span>Year))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="head-output-data-frame" class="level1">
<h1><strong><em>Head output data frame</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_world_melt) <span class="sc">%&gt;%</span> <span class="fu">data_table</span>() <span class="co">#%&gt;% </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="head-output-kenya-data" class="level1">
<h1><strong><em>Head output kenya data</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>kenya_2011 <span class="ot">&lt;-</span> df_world_melt[Country_Name <span class="sc">==</span> <span class="st">"Kenya"</span> <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">2011</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kenya_2011) <span class="co">#%&gt;% data_table() %&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "70%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="head-output-kenya-data-and-saving-files" class="level1">
<h1><strong><em>Head output kenya data and saving files</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">head</span>(kenya_2011, <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"kenya data.csv"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>kenya_2011_na <span class="ot">&lt;-</span> kenya_2011[<span class="sc">!</span><span class="fu">is.na</span>(kenya_2011<span class="sc">$</span>Indicator_value),]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">head</span>(kenya_2011_na, <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"kenya data without na.csv"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kenya_2011_na) <span class="sc">%&gt;%</span> <span class="fu">data_table</span>() <span class="co">#%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># data_table_styling() %&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "70%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#<strong><em>Task 3</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>figari_sheet1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Figari Bank.xlsx"</span> ) <span class="sc">%&gt;%</span> <span class="fu">setDT</span>()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>figari_sheet2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Figari Bank.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span> <span class="fu">setDT</span>()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>figari_sheet2[,  Dates <span class="sc">:</span><span class="er">=</span> <span class="fu">as.Date</span>(Dates, <span class="at">origin =</span> <span class="st">"1900-01-01"</span>)]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>figari_sheet2[,  year <span class="sc">:</span><span class="er">=</span> <span class="fu">year</span>(Dates)]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>figari_sheet2[,  month <span class="sc">:</span><span class="er">=</span> <span class="fu">month</span>(Dates)]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>figari_sheet2[, month <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(month) <span class="sc">==</span> <span class="dv">1</span> ,<span class="fu">paste</span>(<span class="dv">0</span>, month), month)]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>figari_sheet2[,  week_day <span class="sc">:</span><span class="er">=</span> <span class="fu">as.POSIXlt</span>(Dates)<span class="sc">$</span>wday<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>figari_sheet2[, week_day <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(week_day) <span class="sc">==</span> <span class="dv">1</span> ,<span class="fu">paste</span>(<span class="dv">0</span>, week_day), week_day)]</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>figari_sheet2[,  week_no <span class="sc">:</span><span class="er">=</span> <span class="fu">week</span>(Dates)]</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>figari_sheet2[, week_no <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(week_no) <span class="sc">==</span> <span class="dv">1</span> ,<span class="fu">paste</span>(<span class="dv">0</span>, week_no), week_no)]</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>figari_sheet2[,  day_month <span class="sc">:</span><span class="er">=</span> <span class="fu">format</span>(Dates, <span class="st">"%d"</span>)]</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>figari_sheet2_m <span class="ot">&lt;-</span> <span class="fu">melt</span>(figari_sheet2[, <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">with =</span> F], <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"Amount"</span>, <span class="st">"Saving Mode"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-3-plots" class="level1">
<h1>Task 3 Plots</h1>
<ul>
<li>Time series will enable us too see if there is seasonal/cyclic effects/trend</li>
<li>week number after every two weeks, maybe end month</li>
<li>Smoothing/decoposing often needed to see trend</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>figari_dat <span class="ot">&lt;-</span> figari_sheet2_m <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Saving Mode</span><span class="st">`</span>,variable, value) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Average =</span> <span class="fu">mean</span>(Amount)) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(figari_dat<span class="sc">$</span><span class="st">`</span><span class="at">Saving Mode</span><span class="st">`</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Average Savings for"</span>, titles)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>figari_dat_split <span class="ot">&lt;-</span> <span class="fu">split</span>(figari_dat, figari_dat<span class="sc">$</span><span class="st">`</span><span class="at">Saving Mode</span><span class="st">`</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plots_figari <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(figari_dat_split)) {</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    this <span class="ot">=</span> figari_dat_split[[i]]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#write.csv(this, file = "this.csv", row.names = F)</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>   plots_figari[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(this, <span class="fu">aes</span>(value, Average)) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">data =</span> this, <span class="fu">aes</span>(value, Average, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>       ggthemes<span class="sc">::</span><span class="fu">theme_hc</span>()<span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Average amount saved (KES)"</span>, <span class="at">title =</span> titles[i])<span class="co"># +</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>       <span class="co">#theme(axis.text.x = element_text(angle = 30, vjust = 1, hjust = 1))</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="average-amount-saved-at-the-bank" class="level1">
<h1><strong><em>Average Amount saved at the Bank</em></strong></h1>
<ul>
<li>Year no visible trend/ few years</li>
<li>first two months higher savings</li>
<li>lowest between month 3 to month 8</li>
<li>Save more from day 2 - day 4</li>
<li>Week 1- 3 more savings drops to week 10</li>
<li>more save less in around day 10 of the month</li>
<li>decreasing trend trend from day 4 -10</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plots_figari[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="average-amount-saved-at-the-agent" class="level1">
<h1><strong><em>Average Amount saved at the Agent</em></strong></h1>
<ul>
<li>Save more from March to June</li>
<li>Increasing trend from week 1 to 23 then decreasing</li>
<li>Save less towards end of a month</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plots_figari[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="average-amount-saved-mobile-money" class="level1">
<h1><strong><em>Average Amount saved Mobile money</em></strong></h1>
<ul>
<li>on average</li>
<li>save less from month 3 to 6</li>
<li>save less from week 9 to 22</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plots_figari[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="end-month-savings-favourite-tool" class="level1">
<h1><strong><em>End Month Savings Favourite tool</em></strong></h1>
<ul>
<li>I’m thinking about the number of times someone saves. Average maybe skewed.</li>
<li>Women prefer to save using agent</li>
<li>In regions no Nyeri</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(figari_sheet2)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">names</span>(figari_sheet1)[<span class="dv">1</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>figari_comb <span class="ot">&lt;-</span> <span class="fu">merge</span>(figari_sheet2, figari_sheet1, <span class="at">by =</span> <span class="st">"CustomerID"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>end_month <span class="ot">&lt;-</span> figari_comb <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(day_month, <span class="st">`</span><span class="at">Saving Mode</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Freq<span class="sc">/</span><span class="fu">sum</span>(Freq), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#The number of times one deposits</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(end_month, <span class="fu">aes</span>(day_month, Freq )) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span><span class="st">`</span><span class="at">Saving Mode</span><span class="st">`</span>, <span class="at">group =</span><span class="st">`</span><span class="at">Saving Mode</span><span class="st">`</span> ), <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_hc</span>()<span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_hc</span>(<span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="histogram-deposits" class="level1">
<h1>Histogram Deposits</h1>
<ul>
<li>What you would expect.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>deposits <span class="ot">&lt;-</span> figari_sheet2[, .(<span class="at">freq =</span> .N), by <span class="ot">=</span> CustomerID] </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#approximmately poison</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(deposits<span class="sc">$</span>freq, <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Deposits"</span>, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Deposits"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subset-people-who-have-made-one-deposit" class="level1">
<h1><strong><em>Subset People who have made one deposit</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>figari_deposits <span class="ot">&lt;-</span> <span class="fu">merge</span>(deposits, figari_sheet1, <span class="at">by =</span> <span class="st">"CustomerID"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>figari_deposits_one <span class="ot">&lt;-</span> figari_deposits[freq <span class="sc">==</span> <span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="demographic-characteristics-of-those-who-have-only-made-one-deposit" class="level1">
<h1><strong><em>Demographic characteristics of those who have only made one deposit</em></strong></h1>
</section>
<section id="gender" class="level1">
<h1><strong><em>Gender</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>figari_deposits_one <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Gender) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">freq=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Perc =</span><span class="fu">round</span>(freq<span class="sc">/</span><span class="fu">sum</span>(freq) <span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>()<span class="co"># %&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="region" class="level1">
<h1><strong><em>Region</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>figari_deposits_one <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">freq=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Perc =</span><span class="fu">round</span>(freq<span class="sc">/</span><span class="fu">sum</span>(freq) <span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>() <span class="co">#%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "100%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="age" class="level1">
<h1><strong><em>Age</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>figari_deposits_one <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Mean=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Age), <span class="dv">2</span>), <span class="at">Median  =</span> <span class="fu">median</span>(Age)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_table</span>() <span class="co">#%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="task-4" class="level1">
<h1><strong><em>Task 4</em></strong></h1>
</section>
<section id="project-motivation" class="level1">
<h1><strong><em>Project Motivation</em></strong></h1>
<p>Data has the potential to transform business and drive the creation of business value. It can be used for a range of tasks such visualization relationships between variables to predicting if an event will occur. The later is one of the heavily reaserched areas in recent times. The reason for this is that data has grown exponentially and so does the computing power. Banks and financial institutions used data analytics for a range of value such as fraud detetction customer segment, recruiting, credit scoring and so on.</p>
<p>In this study I will use Bogoza data set to build a credit model where an applicat will be avaluated on whether they will default or not.</p>
<p>High accuracy for this model will be required because predicting false positives will eventually cause a business to make a loss and false negatives means that the financial instituion looses business.</p>
</section>
<section id="data-cleaning" class="level1">
<h1><strong><em>Data Cleaning</em></strong></h1>
<p>First step is data cleaning. This ensures that columns are consistent. For instance the target variable had values such as Y y yes where all of them represent yes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#some algorithms like xgboost take numeric data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#you can convert binary vars to 1,0</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and form dummie variables using library dummies</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for variables with more than 2 categories</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>borogoza <span class="ot">&lt;-</span> <span class="fu">setDT</span>(<span class="fu">read_csv</span>( <span class="st">"Bagorogoza Loan.csv"</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>borogoza[, Target <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"y|Y"</span>, Target), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>borogoza[, Gender <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^m$|^male$"</span>, <span class="fu">tolower</span>(Gender)), <span class="dv">0</span>, <span class="dv">1</span>)]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>borogoza[, Married <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Yes"</span>,Married), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>borogoza[, Education <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"not"</span>, <span class="fu">tolower</span>(Education)), <span class="dv">0</span>, <span class="dv">1</span>)]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>borogoza[, Self_Employed <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Yes"</span>,Self_Employed), <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>borogoza[, Property_Area <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"rural"</span>,<span class="fu">tolower</span>(Property_Area)), <span class="st">"Rural"</span>, Property_Area)]</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>borogoza[, Property_Area <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"semi"</span>,<span class="fu">tolower</span>(Property_Area)), <span class="st">"Semi-urban"</span>, Property_Area)]</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>borogoza[, Property_Area <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^urban$"</span>,<span class="fu">tolower</span>(Property_Area)), <span class="st">"Urban"</span>, Property_Area)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variable-selection" class="level1">
<h1><strong><em>Variable Selection</em></strong></h1>
<ul>
<li>Where we run descripte statistics</li>
</ul>
</section>
<section id="visualize-categorical-variables" class="level1">
<h1><strong><em>Visualize Categorical variables</em></strong></h1>
<p>Visualization and summary statistics is an impostant step before fitting any model as this will give you a glimpse of how the variables are associated with target variable. In this case I will use stacked barplot as from them you can see if the prorpotions of defaulters and non defaulters is equal in defferent categories of a variable. From the graphs we can see that the prorpotion of defaulters and non defaulters is defferent for the different credit history categories. This is aslo seen in the prorpety area. From the categorical variables we can therefore conclude that one of the best predictors is credit history.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> Hmisc<span class="sc">::</span><span class="fu">Cs</span>(ApplicantIncome,CoapplicantIncome, LoanAmount )</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>nms_bo <span class="ot">&lt;-</span> <span class="fu">names</span>(borogoza)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> nms_bo[<span class="sc">!</span>nms_bo <span class="sc">%in%</span> numeric_vars]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>borogoza_catm <span class="ot">&lt;-</span> <span class="fu">melt</span>(borogoza[, cat_vars, <span class="at">with =</span> F], <span class="at">id.vars =</span> <span class="st">"Target"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>borogoza_catm_perc <span class="ot">&lt;-</span>borogoza_catm  <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(variable, value, Target) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">freq=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">perc =</span><span class="fu">round</span>(freq<span class="sc">/</span><span class="fu">sum</span>(freq) <span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>) )</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(borogoza_catm_perc, <span class="fu">aes</span>(value, perc, <span class="at">fill =</span> <span class="fu">factor</span>(Target) )) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_economist</span>(<span class="at">name =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-numeric-variables" class="level1">
<h1><strong><em>Visualize numeric variables</em></strong></h1>
<p>For the numeric variables boxplot help us visualize which distribution is different from the other. Non overlapping boxplot for defaulters and non defaulters may indicate that the mean/median values in the two groups was significantly different. From this we can see that it’s unlikely that education and self employment affect loan repayment and for this we drop this two variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>borogoza_numm <span class="ot">&lt;-</span> <span class="fu">melt</span>(borogoza[, <span class="fu">c</span>(numeric_vars, <span class="st">"Target"</span>), <span class="at">with =</span> F], <span class="at">id.vars =</span> <span class="st">"Target"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(borogoza_numm, <span class="fu">aes</span>(<span class="fu">as.factor</span>(Target), <span class="fu">scale</span>(value ))) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="one-hot-encoding-for-categorical-variables-with-more-than-2-levels" class="level1">
<h1><strong><em>One-Hot Encoding for categorical variables with more than 2 levels</em></strong></h1>
<p>In this step variables with more than two categories are converted to dummies variables. The first column in each category is dropped as it’s linearly dependent with the second column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chars <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(borogoza[, <span class="sc">-</span><span class="dv">1</span>, <span class="at">with =</span> F], is.character)) </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>chars <span class="ot">&lt;-</span> nms_bo[chars]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dummies)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>borogoza_dummy <span class="ot">&lt;-</span> <span class="fu">dummy.data.frame</span>(borogoza, <span class="at">names =</span> <span class="fu">c</span>(chars, <span class="st">"Loan_Amount_Term"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setDT</span>()</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>borogoza_dummy[, Loan_ID <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>borogoza_dummy[, Loan_Amount_Term36 <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>borogoza_dummy[, <span class="st">`</span><span class="at">Property_AreaSemi-urban</span><span class="st">`</span> <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>borogoza_dummy[, <span class="st">`</span><span class="at">Dependents1</span><span class="st">`</span> <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scale-variables" class="level1">
<h1><strong><em>Scale variables</em></strong></h1>
<p>It’s important to scale your variables since it leads to faster convergence and since some algorithm use distances to find decision boundary this means that variables with big values will have a big influence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>xvars <span class="ot">&lt;-</span> <span class="fu">names</span>(borogoza_dummy)[<span class="sc">!</span><span class="fu">names</span>(borogoza_dummy) <span class="sc">%in%</span> <span class="st">"Target"</span>]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>borogoza_dummy[, (xvars) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">scale</span>(x)), .SDcols <span class="ot">=</span> xvars ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="split-test-and-train-sets" class="level1">
<h1><strong><em>Split test and train sets</em></strong></h1>
<p>This is important as it helps evaluate your model on data it has never seen. The model will be trained on one set(training set) and tested using test set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>) <span class="co"># for reproducibility</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(borogoza_dummy), <span class="fu">round</span>(<span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(borogoza_dummy)))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> borogoza_dummy[train_sample,]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> borogoza_dummy[<span class="sc">-</span>train_sample,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fit-logistic-regression" class="level1">
<h1><strong><em>Fit Logistic Regression</em></strong></h1>
<p>Logistic regression was fit to predict the probability of someone defaulting. The advantages of logistic regression is interpret table, ie you can see the association between a predictor and response value, it also gives a probability. This is very important when you want to have your own cut off point eg you want to label someone as a defaulter if you the predicted probability is more than 0.7. This increases precision but lowers recall. Using step wise selection the model was used to select the variables that best predict loan default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Target <span class="sc">~</span> Married <span class="sc">+</span> CoapplicantIncome <span class="sc">+</span> Loan_Amount_Term60 <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    Loan_Amount_Term180 <span class="sc">+</span> Loan_Amount_Term300 <span class="sc">+</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     Loan_Amount_Term360 <span class="sc">+</span> Credit_History <span class="sc">+</span> Property_AreaRural <span class="sc">+</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>     Property_AreaUrban ,<span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>borogoza_dummy <span class="ot">&lt;-</span> borogoza_dummy[, .(Target,Married , CoapplicantIncome , Loan_Amount_Term60 , </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>     Loan_Amount_Term180 , Loan_Amount_Term300 , </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>     Loan_Amount_Term360 , Credit_History , Property_AreaRural , </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>     Property_AreaUrban)]</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> borogoza_dummy[train_sample,]</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> borogoza_dummy[<span class="sc">-</span>train_sample,]</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>fit_glm <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">data_table</span>()<span class="co"># %&gt;%</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># data_table_styling() %&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scroll_box(width = "100%", height = "100%")</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">#MASS::stepAIC(fit_glm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The estimate column shows the log odds. Positive values means that the variable makes it more likely for a person to repay their loan negative values means that the person is less likely to repay.</p>
</section>
<section id="confusion-matrix-logistic-regression" class="level1">
<h1><strong><em>Confusion Matrix Logistic regression</em></strong></h1>
<p>The confusion matrix evaluate correctly classified cases. A perfect fit will have all values in the main diagnose while the entries of lower/upper triangular should be zeros. In this case we have 14 cases of false positives and 7 cases of false negatives the accuracy of the model is 0.82 with and f1 score of 0.87. F1 score is a very important evaluation metric where there is unbalanced classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pred_glm <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_glm,<span class="at">newdata =</span> test)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>pred_glm <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_glm<span class="sc">&gt;</span><span class="fl">0.7</span>, <span class="dv">1</span> , <span class="dv">0</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>Target, pred_glm) <span class="sc">%&gt;%</span> <span class="fu">data_table</span>()<span class="co"># %&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="accuracy-logistic-regression" class="level1">
<h1><strong><em>Accuracy Logistic regression</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>Target, pred_glm) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">confusionMatrix</span>(<span class="at">positive =</span> <span class="st">"1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">data_table</span>()<span class="co"># %&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># data_table_styling() %&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scroll_box(width = "100%", height = "100%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="area-under-curve" class="level1">
<h1><strong><em>Area under curve</em></strong></h1>
<p>This is important as it will help you know if the suffers from high false negatives or false positives. A value greater than 0.8 is normally desired in this case we achieve 0.74.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc</span>(<span class="fu">as.numeric</span>(test<span class="sc">$</span>Target), pred_glm, <span class="at">print.auc=</span>T, <span class="at">print.auc.y=</span><span class="fl">0.5</span>, <span class="at">levels =</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cross-validation-svm" class="level1">
<h1><strong><em>Cross Validation SVM</em></strong></h1>
<p>Next we fit Support vector machine model. We start by finding the best parameters using cross validation. We use 10 fold this where train set is randomly split into 10 sets. In each cases one of the 1 set is used as a validation/test set while the other 9 are used to train the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tune.out <span class="ot">=</span> <span class="fu">tune</span>(svm, <span class="fu">as.factor</span>(Target)<span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">kernel =</span><span class="st">"radial"</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span><span class="st">"C-classification"</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ranges =</span><span class="fu">list</span> (<span class="at">cost=</span><span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span> ,<span class="dv">5</span> ,  <span class="dv">10</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,  <span class="fl">0.1</span>, <span class="dv">1</span> ,<span class="dv">5</span> )))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tune.out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="confusion-matrix-svm" class="level1">
<h1><strong><em>Confusion Matrix SVM</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fit_svm <span class="ot">&lt;-</span> <span class="fu">svm</span>(<span class="fu">as.factor</span>(Target)<span class="sc">~</span>., <span class="at">data =</span> train, <span class="at">cost =</span><span class="dv">5</span>  , <span class="at">gamma =</span> .<span class="dv">01</span>, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel =</span> <span class="st">"radial"</span>, <span class="at">type =</span><span class="st">"C-classification"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>pred_svm <span class="ot">&lt;-</span><span class="fu">predict</span>(fit_svm, <span class="at">newdata =</span> test)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>Target, pred_svm) <span class="sc">%&gt;%</span> <span class="fu">data_table</span>() <span class="co">#%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># data_table_styling() %&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "30%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="area-under-curve-1" class="level1">
<h1><strong><em>Area under curve</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc</span>(test<span class="sc">$</span>Target, <span class="fu">as.numeric</span>(pred_svm), <span class="at">print.auc=</span>T, <span class="at">print.auc.y=</span><span class="fl">0.5</span>, <span class="at">levels =</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="accuracy-svm" class="level1">
<h1><strong><em>Accuracy SVM</em></strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test<span class="sc">$</span>Target, pred_svm) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">confusionMatrix</span>(<span class="at">positive =</span> <span class="st">"1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">data_table</span>() <span class="co">#%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data_table_styling() %&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scroll_box(width = "100%", height = "100%")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="validation-curves" class="level1">
<h1><strong><em>Validation Curves</em></strong></h1>
<p>The two models almost give equal results based on accuracy, f1 score and area under the curve. In this section we will evaluate the models using learning curves to see if they suffer from high variance or bias. In this case the model suffers from high bias. It’s evident that adding more data won’t solve accuracy problems. In this case additional features would help.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>sets <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">50</span>, <span class="at">to =</span> <span class="fu">nrow</span>(train), <span class="at">by =</span> <span class="dv">50</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sets[<span class="fu">length</span>(sets)] <span class="ot">&lt;-</span><span class="fu">nrow</span>(train) </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>train.err <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>test.err<span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sets)) {</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    traini <span class="ot">=</span> train[<span class="dv">1</span><span class="sc">:</span>sets[i],]</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    fit_svm <span class="ot">&lt;-</span> <span class="fu">svm</span>(<span class="fu">as.factor</span>(Target)<span class="sc">~</span>., <span class="at">data =</span> traini, <span class="at">cost =</span><span class="dv">5</span>  , <span class="at">gamma =</span> .<span class="dv">01</span>, </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">kernel =</span> <span class="st">"radial"</span>, <span class="at">type =</span><span class="st">"C-classification"</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    pred_train <span class="ot">=</span> <span class="fu">predict</span>(fit_svm, <span class="at">newdata =</span> traini)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    train.err[i] <span class="ot">=</span><span class="dv">1</span> <span class="sc">-</span>  <span class="fu">mean</span>(pred_train <span class="sc">==</span> traini<span class="sc">$</span>Target)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_svm, <span class="at">newdata =</span> test)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    test.err[i] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(test<span class="sc">$</span>Target <span class="sc">==</span> pred_test)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(i,<span class="st">" "</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(sets, <span class="fu">cbind</span>(test.err, train.err), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">ylab =</span> <span class="st">"Error"</span>, <span class="at">xlab =</span> <span class="st">"Train sample size"</span>, <span class="at">main =</span> <span class="st">"SVM Training and Validation errors"</span>)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Test"</span>, <span class="st">"Train"</span>), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="deployment" class="level1">
<h1><strong><em>Deployment</em></strong></h1>
<p>Other model like Xgboost which uses boosting and bagging could first be used to see if the model performs better on this data. The problem could after this be intergrated with a loan evaluation software where it can help loan officers decide if the will award a loan.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
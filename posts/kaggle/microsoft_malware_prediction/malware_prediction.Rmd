---
title: "Malware prediction"
author: "Mburu"
date: "11/12/2020"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float:
      collapsed: false
      smooth_scroll: false
    theme: united
    highlight: pygments
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE )
```

## 

```{r}
library(tidyverse)
library(data.table)
library(ggthemes)
library(caret)
```

##

```{r pressure, echo=FALSE}
micro_train <- fread("micro_train.csv")
#micro_test <- fread("micro_test.csv")
```


```{r}
set.seed(100)
sample_sub <- sample(nrow(micro_train), 1000000)
micro_train_sub <- micro_train[sample_sub,]

nrow_train <- nrow(micro_train_sub)

sample_train <- sample(nrow_train, as.integer(nrow_train * 0.7))

malware_train <- micro_train_sub[sample_train]

malware_test <- micro_train_sub[-sample_train]
```


```{r}
na_tally <- round(colSums(is.na(micro_train_sub))/nrow(micro_train_sub) * 100, 2)

na_tally <- na_tally[na_tally != 0]

nms_na <- names(na_tally)

na_dt <- data.table(var = nms_na, perc = na_tally)

ggplot(na_dt, aes(reorder(var, perc), perc)) +
    geom_bar(stat = "identity") +
    coord_flip()+
    theme(axis.text.x = element_text(size = 10))
```


```{r}
na_over25 <- na_dt[perc>25, var]

micro_train_sub[, (na_over25) := NULL]

na_under25dt <- na_dt[perc <= 25]
val_del <- na_dt[between(perc,6, 25), var]

ggplot(na_under25dt, aes(reorder(var, perc), perc)) +
    geom_bar(stat = "identity") +
    coord_flip()+
    theme(axis.text.y = element_text(size = 10))
```

